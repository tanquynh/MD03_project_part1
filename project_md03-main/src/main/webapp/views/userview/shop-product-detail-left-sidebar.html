<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <th:block th:insert="userview/layouts/head.html"></th:block>
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800,900&display=swap"
          rel="stylesheet">
    <style>

        /* Biểu tượng thích */
        .icon-like {
            margin-left: 90px;
            color: #ff0000; /* Màu của biểu tượng thích */
            cursor: pointer; /* Con trỏ chuột thành dấu nhấp */
        }

        /* Hiệu ứng hover */
        .icon-like:hover {
            color: blue; /* Màu sắc thay đổi khi hover */
        }
    </style>

</head>

<body>

<!-- LOADER -->
<!--<div class="preloader">-->
<!--    <div class="lds-ellipsis">-->
<!--        <span></span>-->
<!--        <span></span>-->
<!--        <span></span>-->
<!--    </div>-->
<!--</div>-->
<!-- END LOADER -->

<!-- Home Popup Section -->

<!-- End Screen Load Popup Section -->

<!-- START HEADER -->
<th:block th:insert="userview/layouts/header.html"></th:block>
<!-- END HEADER -->

<!-- START SECTION BREADCRUMB -->
<div class="breadcrumb_section bg_gray page-title-mini">
    <div class="container"><!-- STRART CONTAINER -->
        <div class="row align-items-center">
            <div class="col-md-6">
                <div class="page-title">
                    <h1>Product Detail Left Sidebar</h1>
                </div>
            </div>
            <div class="col-md-6">
                <ol class="breadcrumb justify-content-md-end">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Pages</a></li>
                    <li class="breadcrumb-item active">Product Detail Left Sidebar</li>
                </ol>
            </div>
        </div>
    </div><!-- END CONTAINER-->
</div>
<!-- END SECTION BREADCRUMB -->

<!-- START MAIN CONTENT -->
<div class="main_content">

    <!-- START SECTION SHOP -->
    <div class="section">
        <div class="container">
            <div class="row">
                <div class="col-xl-9 col-lg-8">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 mb-4 mb-md-0">
                            <div class="product-image">
                                <div class="product_img_box">
                                    <img id="product_img" th:src="${product.image}"/>
                                    <a href="#" class="product_img_zoom" title="Zoom">
                                        <span class="linearicons-zoom-in"></span>
                                    </a>
                                </div>
                                <div id="pr_item_gallery" class="product_gallery_item slick_slider"
                                     data-slides-to-show="4" data-slides-to-scroll="1" data-infinite="false"
                                     th:each="item : ${product.getImageList()}">
                                    <div class="item">
                                        <a href="#" class="product_gallery_item active"
                                           data-image="assets/images/product_img1.jpg"
                                           data-zoom-image="assets/images/product_zoom_img1.jpg">
                                            <img th:src="${item.getSrc()}" alt="product_small_img1"/>
                                        </a>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            <div class="pr_detail">
                                <div class="product_description">
                                    <h4 class="product_title" th:text="${product.productName}"><a href="#">Blue Dress
                                        For Woman</a></h4>
                                    <div class="product_price">
                                        <span class="price" th:text="${product.price}">$45.00</span>
                                        <del>$55.25</del>
                                        <div class="on_sale">
                                            <span>35% Off</span>
                                        </div>
                                    </div>
                                    <div class="rating_wrap">
                                        <div class="rating">
                                            <div class="product_rate" style="width:80%"></div>
                                        </div>
                                        <span class="rating_num">(21)</span>
                                    </div>
                                    <div class="pr_desc" th:text="${product.description}">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus blandit
                                            massa enim. Nullam id varius nunc id varius nunc.</p>
                                    </div>
                                    <div class="product_sort_info">
                                        <ul>
                                            <li><i class="linearicons-shield-check"></i> 1 Year AL Jazeera Brand
                                                Warranty
                                            </li>
                                            <li><i class="linearicons-sync"></i> 30 Day Return Policy</li>
                                            <li><i class="linearicons-bag-dollar"></i> Cash on Delivery available</li>
                                        </ul>
                                    </div>
                                    <div class="pr_switch_wrap">
                                        <span class="switch_lable">Color</span>
                                        <div class="product_color_switch">
                                            <span class="active" data-color="#87554B"></span>
                                            <span data-color="#333333"></span>
                                            <span data-color="#DA323F"></span>
                                        </div>
                                    </div>

                                </div>
                                <hr/>
                                <div class="cart_extra">
                                    <div class="cart-product-quantity">
                                        <div class="quantity">
                                            <input type="button" value="-" class="minus">
                                            <input type="text" name="quantity" value="1" title="Qty" class="qty"
                                                   size="4">
                                            <input type="button" value="+" class="plus">
                                        </div>
                                    </div>
                                    <div class="cart_btn">
                                        <button class="btn btn-fill-out btn-addtocart" type="button"
                                                th:data-product-id="${product.productId}">
                                            <i class="icon-basket-loaded"></i> Add to cart
                                        </button>

                                        <a class="add_compare  compare-add" href="#"
                                           th:data-product-id="${product.productId}"><i class="icon-shuffle"></i></a>
                                        <a class="add_wishlist wishlist-add" href="#"
                                           th:data-product-id="${product.productId}"><i class="icon-heart"></i></a>
                                        <span th:data-product-id="${product.productId}"
                                              class="icon-like like-add"></span>
                                    </div>
                                </div>
                                <hr/>


                                <div class="product_share">
                                    <span>Share:</span>
                                    <ul class="social_icons">
                                        <li><a href="#"><i class="ion-social-facebook"></i></a></li>
                                        <li><a href="#"><i class="ion-social-twitter"></i></a></li>
                                        <li><a href="#"><i class="ion-social-googleplus"></i></a></li>
                                        <li><a href="#"><i class="ion-social-youtube-outline"></i></a></li>
                                        <li><a href="#"><i class="ion-social-instagram-outline"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="large_divider clearfix"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="tab-style3">
                                <ul class="nav nav-tabs" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="Description-tab" data-bs-toggle="tab"
                                           href="#Description" role="tab" aria-controls="Description"
                                           aria-selected="true">Description</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="Additional-info-tab" data-bs-toggle="tab"
                                           href="#Additional-info" role="tab" aria-controls="Additional-info"
                                           aria-selected="false">Additional info</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="Reviews-tab" data-bs-toggle="tab" href="#Reviews"
                                           role="tab" aria-controls="Reviews" aria-selected="false">Reviews (2)</a>
                                    </li>
                                </ul>
                                <div class="tab-content shop_info_tab">
                                    <div class="tab-pane fade show active" id="Description" role="tabpanel"
                                         aria-labelledby="Description-tab">
                                        <p>Contrary to popular belief, Lorem Ipsum is not simply random text. It has
                                            roots in a piece of classical Latin literature from 45 BC, making it over
                                            2000 years old. Vivamus bibendum magna Lorem ipsum dolor sit amet,
                                            consectetur adipiscing elit.Contrary to popular belief, Lorem Ipsum is not
                                            simply random text. It has roots in a piece of classical Latin literature
                                            from 45 BC, making it over 2000 years old.</p>
                                        <p>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis
                                            praesentium voluptatum deleniti atque corrupti quos dolores et quas
                                            molestias excepturi sint occaecati cupiditate non provident, similique sunt
                                            in culpa qui officia deserunt mollitia animi, id est laborum et dolorum
                                            fuga. Et harum quidem rerum facilis est et expedita distinctio.</p>
                                    </div>
                                    <div class="tab-pane fade" id="Additional-info" role="tabpanel"
                                         aria-labelledby="Additional-info-tab">
                                        <table class="table table-bordered">
                                            <tr>
                                                <td>Capacity</td>
                                                <td>5 Kg</td>
                                            </tr>
                                            <tr>
                                                <td>Color</td>
                                                <td>Black, Brown, Red,</td>
                                            </tr>
                                            <tr>
                                                <td>Water Resistant</td>
                                                <td>Yes</td>
                                            </tr>
                                            <tr>
                                                <td>Material</td>
                                                <td>Artificial Leather</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="tab-pane fade" id="Reviews" role="tabpanel"
                                         aria-labelledby="Reviews-tab">
                                        <div class="comments">
                                            <h5 class="product_tab_title">2 Review For <span>Blue Dress For Woman</span>
                                            </h5>
                                            <ul class="list_none comment_list mt-4">
                                                <li>
                                                    <div class="comment_img">
                                                        <img src="https://firebasestorage.googleapis.com/v0/b/project-md03-javaweb.appspot.com/o/human.jpg?alt=media&token=9eb4c0d8-74fa-433e-894d-c152119c288c" alt="user1"/>
                                                    </div>
                                                    <div class="comment_block">
                                                        <div class="rating_wrap">
                                                            <div class="rating">
                                                                <div class="product_rate" style="width:80%"></div>
                                                            </div>
                                                        </div>
                                                        <p class="customer_meta">
                                                            <span class="review_author">Alea Brooks</span>
                                                            <span class="comment-date">March 5, 2018</span>
                                                        </p>
                                                        <div class="description">
                                                            <p>Lorem Ipsumin gravida nibh vel velit auctor aliquet.
                                                                Aenean sollicitudin, lorem quis bibendum auctor, nisi
                                                                elit consequat ipsum, nec sagittis sem nibh id elit.
                                                                Duis sed odio sit amet nibh vulputate</p>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="comment_img">
                                                        <img src="https://firebasestorage.googleapis.com/v0/b/project-md03-javaweb.appspot.com/o/human.jpg?alt=media&token=9eb4c0d8-74fa-433e-894d-c152119c288c" alt="user2"/>
                                                    </div>
                                                    <div class="comment_block">
                                                        <div class="rating_wrap">
                                                            <div class="rating">
                                                                <div class="product_rate" style="width:60%"></div>
                                                            </div>
                                                        </div>
                                                        <p class="customer_meta">
                                                            <span class="review_author">Grace Wong</span>
                                                            <span class="comment-date">June 17, 2018</span>
                                                        </p>
                                                        <div class="description">
                                                            <p>It is a long established fact that a reader will be
                                                                distracted by the readable content of a page when
                                                                looking at its layout. The point of using Lorem Ipsum is
                                                                that it has a more-or-less normal distribution of
                                                                letters</p>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="review_form field_form">
                                            <h5>Add a review</h5>
                                            <form id="reviewForm" class="row mt-3" th:action="@{/add-comment-ajax}" method="post">
                                                <div class="form-group col-12 mb-3">
                                                    <div class="star_rating">
                                                        <span th:data-value="1"><i class="far fa-star"></i></span>
                                                        <span th:data-value="2"><i class="far fa-star"></i></span>
                                                        <span th:data-value="3"><i class="far fa-star"></i></span>
                                                        <span th:data-value="4"><i class="far fa-star"></i></span>
                                                        <span th:data-value="5"><i class="far fa-star"></i></span>
                                                    </div>
                                                    <input type="hidden" id="ratingValue" th:data-rating="rating"
                                                           value="0">
                                                </div>
                                                <div type="hidden" class="productIdAdd" name="productId"
                                                     th:data-product-id="${product.productId}"></div>
                                                <div class="form-group col-12 mb-3">
                                                    <textarea required="required" placeholder="Your review *"
                                                              class="form-control comment-add" th:data-comment="message"
                                                              rows="4"></textarea>
                                                </div>
                                                <div class="form-group col-12 mb-3">
                                                    <button type="submit" class="btn btn-fill-out submit-comment"
                                                            name="submit" value="Submit">Submit Review
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="small_divider"></div>
                            <div class="divider"></div>
                            <div class="medium_divider"></div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!-- END SECTION SHOP -->

    <!-- START SECTION SUBSCRIBE NEWSLETTER -->
    <div class="section bg_default small_pt small_pb">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="heading_s1 mb-md-0 heading_light">
                        <h3>Subscribe Our Newsletter</h3>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="newsletter_form">
                        <form>
                            <input type="text" required="" class="form-control rounded-0"
                                   placeholder="Enter Email Address">
                            <button type="submit" class="btn btn-dark rounded-0" name="submit" value="Submit">
                                Subscribe
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- START SECTION SUBSCRIBE NEWSLETTER -->

</div>
<!-- END MAIN CONTENT -->

<!-- START FOOTER -->
<th:block th:insert="userview/layouts/footer.html"></th:block>
<!-- END FOOTER -->

<a href="#" class="scrollup" style="display: none;"><i class="ion-ios-arrow-up"></i></a>

<th:block th:insert="userview/layouts/scrip.html"></th:block>
<script th:inline="javascript">
    $(document).ready(function () {
        $('.btn-addtocart').on('click', function () {
            var productId = $(this).data('product-id'); // Lấy productId từ thuộc tính data-product-id của nút
            var quantity = $('.cart-product-quantity .qty').val(); // Lấy giá trị số lượng từ input
            console.log(productId);
            console.log(quantity);
            addToCart(productId, quantity);
        });

        function addToCart(productId, quantity) {
            $.ajax({
                type: 'GET',
                url: `/addToCartQty?productId=${productId}&quantity=${quantity}`,
                success: function () {
                    console.log('Sản phẩm đã được thêm vào giỏ hàng');
                },
                error: function (xhr, status, error) {
                    console.error('Lỗi khi thêm sản phẩm vào giỏ hàng:', error);

                }
            });
        }
    });
</script>

<script>

    $('.wishlist-add').on('click', function (e) {
        e.preventDefault();
        var product = $(this).data('product-id');
        console.log(product)
        $.ajax({
            type: 'GET',
            url: `/add-wishlist?productId=` + product,
            success: function () {
                console.log('Sản phẩm đã được thêm vào mục yeu thich');
            },
            error: function () {
                console.error('Lỗi khi thêm sản phẩm vào mục yeu thich:');

            }
        });

    });
</script>
<script>

    $('.compare-add').on('click', function (e) {
        e.preventDefault();
        var product = $(this).data('product-id');
        console.log(product)
        $.ajax({
            type: 'GET',
            url: `/add-compare?productId=` + product,
            success: function () {
                console.log('Sản phẩm đã được thêm vào mục compare');
            },
            error: function () {
                console.error('Lỗi khi thêm sản phẩm vào mục compare:');

            }
        });

    });
</script>

<script>
    $(document).ready(function () {
        // Xử lý khi người dùng nhấn nút submit trên biểu mẫu
        $('#reviewForm').submit(function (e) {
            e.preventDefault(); // Ngăn chặn việc gửi biểu mẫu và tải lại trang

            // Lấy giá trị đánh giá, productId và comment từ các thành phần trên biểu mẫu
            var rating = $('#ratingValue').val();
            var productId = $('.productIdAdd').data('product-id');
            var comment = $('.comment-add').val();
            console.log(rating);
            console.log(productId);
            console.log(comment);

            // Gửi dữ liệu lên server thông qua Ajax
            $.ajax({
                type: 'GET',
                url: `/add-comment-ajax?productId=${productId}&rating=${rating}&comment=${comment}`, // Đường dẫn của controller trong Spring Boot để xử lý dữ liệu đánh giá
                success: function (response) {
                    alert('Đánh giá đã được gửi thành công!');
                    // Cập nhật giao diện người dùng nếu cần
                },
                error: function (xhr, status, error) {
                    alert('Lỗi khi gửi đánh giá. Vui lòng thử lại sau.');
                    console.error('Lỗi khi gửi đánh giá:', error);
                }
            });
        });

        // Xử lý khi người dùng click vào sao để đánh giá
        $('.star_rating span').on('click', function () {
            var value = $(this).data('value'); // Lấy giá trị đánh giá từ thuộc tính data-value của sao
            $('#ratingValue').val(value); // Đặt giá trị đánh giá vào input hidden


        });
    });
</script>
<script>

    $('.like-add').on('click', function (e) {
        e.preventDefault();
        var product = $(this).data('product-id');
        console.log(product)
        $.ajax({
            type: 'GET',
            url: `/add-likeUser?productId=` + product,
            success: function () {
                console.log('Sản phẩm đã like san pham');
            },
            error: function () {
                console.error('Lỗi khi like san pham:');

            }
        });

    });
</script>

</body>
</html>